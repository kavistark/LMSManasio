{% extends "base1.html" %}

{% block title %}Calendar{% endblock %}

{% load static %}

{% block extra_css %}
  <!-- FullCalendar Styles -->
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet">
  
  <style>

    #calendar {
      max-width: 900px;
      margin: 0 auto;
    }
    
    #event-details-popup {
      position: fixed; /* Keeps it pinned to the viewport */
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-content: center;
      background-color: rgba(0,0,0,0.5);
      z-index: 5000; /* Makes sure it appears above other elements */
    }

    .card {
      border-radius: 18px;
      border: none;
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(12px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
      overflow: hidden;
      animation: fadeIn 0.5s ease;
    }

    .event-details {
      border: 2px solid #0288D1;
      outline: none;
      font-size: 16px;
      padding: 12px;
      border-radius: 20px;
      background: #E3F2FD;
    }

  </style>

  <style>
    .modal-content {
      border-radius: 18px;
      border: none;
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(12px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
      overflow: hidden;
      animation: fadeIn 0.5s ease;
      width: 100vh;
      height: 100%;
    }
    @keyframes fadeIn {
      from {opacity: 0; transform: scale(0.95);}
      to {opacity: 1; transform: scale(1);}
    }
    .modal-header {
      background: linear-gradient(135deg, #007bff, #0056d2);
      color: white;
      padding: 20px;
    }
    .modal-title {
      font-weight: bold;
      font-size: 1.4rem;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .form-control, textarea {
      background-color: #f9fbff;
      border: 1px solid #d6e4ff;
      border-radius: 12px;
      padding-left: 42px;
    }
    .form-group {
      position: relative;
      margin-bottom: 1.2rem;
    }
    .form-group i {
      position: absolute;
      top: 50%;
      left: 14px;
      transform: translateY(-50%);
      color: #4a67c9;
      font-size: 1.1rem;
    }
    .btn-join {
      background: linear-gradient(90deg, #007bff, #0056d2);
      border: none;
      border-radius: 12px;
      padding: 14px;
      font-weight: bold;
      color: #fff;
      width: 100%;
      transition: all 0.3s ease;
    }
    .btn-join:hover {
      background: linear-gradient(90deg, #0056d2, #003b99);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 91, 187, 0.4);
    }
  </style>

{% endblock %}


{% block content %}

  <div id="calendar"></div>

  <!-- <div id="event-details-popu" class="event-details-container" style="display: none;">
      <div class="d-flex justify-content-center">
        <div class="card w-50 shadow px-2 py-2">
          <form>
            <div class="card-body px-4">
              Header
              <div class="container mb-3">
                <div class="d-flex justify-content-between align-items-center text-center">
                  <h2 class="card-title col-11 m-0">Event Details</h2>
                  <button type="button" class="btn-close col-1" aria-label="Close"
                  onclick="document.getElementById('event-details-popup').style.display='none'"
                  ></button>
                </div>
              </div>

              <hr>

              Event Title
              <div class="mb-3">
                <label for="event-title" class="form-label">Event Title</label>
                <input type="text" id="event-title" class="form-control event-details" 
                  name="event-title" aria-label="Event title" 
                  placeholder="Enter event title" readonly>
              </div>

              Event Course
              <div class="mb-3">
                <label for="event-course" class="form-label">Event Course</label>
                <input type="text" id="event-course" class="form-control event-details" 
                  name="event-course" aria-label="Event course" 
                  placeholder="Enter event course" readonly>
              </div>

              Event Description
              <div class="mb-3">
                <label for="event-description" class="form-label">Event Description</label>
                <textarea id="event-description" class="form-control event-details" 
                  name="event-description"  aria-label="Event description" 
                  rows="3" placeholder="Enter event details" readonly></textarea>
              </div>

              Meeting Link
              <div class="mb-3">
                <label for="event-meeting-link" class="form-label">Meeting Link</label>
                <input type="url" id="event-meeting-link" class="form-control event-details" 
                      name="event-meeting-link" aria-label="Meeting link" 
                      placeholder="https://meet.google.com/..." readonly>
              </div>

              Join Meeting Button
              <a href="#" id="event-meeting-link-join" class="btn btn-primary w-100"
              target="_blank">Join Meeting</a>

            </div>
          </form>
        </div>
      </div>
   </div> -->

  <!-- Modal -->
<div id="event-details-popup" class="event-details-container" style="display: none;">
  <div class="d-flex justify-content-center">
    <div class="modal-content">
      
      <!-- Header -->
      <div class="modal-header">
        <h5 class="modal-title" id="eventModalLabel"><i class="fa-solid fa-calendar-days"></i> Event Details</h5>
        <button type="button" class="btn-close btn-close-white" onclick="document.getElementById('event-details-popup').style.display='none'"></button>
      </div>

      <!-- Body -->
      <div class="modal-body px-4 py-3">
        <div class="form-group">
          <i class="fa-solid fa-book"></i>
          <input type="text" id="event-title" class="form-control" 
                  name="event-title" aria-label="Event title" 
                  placeholder="Enter event title" readonly>
        </div>
        <div class="form-group">
          <i class="fa-solid fa-code"></i>
          <input type="text" id="event-course" class="form-control event-details" 
                  name="event-course" aria-label="Event course" 
                  placeholder="Enter event course" readonly>
        </div>
        <div class="form-group">
          <i class="fa-solid fa-pen-to-square"></i>
          <textarea id="event-description" class="form-control event-details" 
                  name="event-description" aria-label="Event description" 
                  rows="3" placeholder="Enter event details" readonly></textarea>
        </div>
        <!-- <div class="form-group">
          <i class="fa-solid fa-link"></i>
          <input type="url" id="event-meeting-link" class="form-control event-details" 
                      name="event-meeting-link" aria-label="Meeting link" 
                      placeholder="https://meet.google.com/..." readonly>
        </div> -->
      
      <div class="form-group border-0">
        <a href="https://www.google.com/" target="_blank" class="btn btn-join">
          üöÄ Join Meeting
        </a>
      </div>

      </div>
    </div>
  </div>
</div>

  
  <!-- FullCalendar JavaScripts -->
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      var myCalendar = document.getElementById('calendar');

      // Initialize FullCalendar      
      // FullCalendar.Calendar ‚Üí a class constructor provided by the FullCalendar library.
      // new FullCalendar.Calendar(element, options) ‚Üí creates a new calendar instance and attaches it to a DOM element (myCalendar here).
      // The first argument is the DOM element where the calendar will render.
      // The second argument is an object with configuration options (initialView, headerToolbar, events, etc.).
      
      var calendar = new FullCalendar.Calendar(myCalendar, {
          initialView: 'dayGridMonth',
          // 'dayGridMonth' is the classic month grid. 
          // Other common views: 'timeGridWeek', 'timeGridDay' for time-based schedules; 'listWeek', 'listMonth' for agenda lists.

          headerToolbar: {
            left: 'prev,next today',
            center: 'title',
            right: 'dayGridMonth,timeGridWeek,timeGridDay'
          },
          // Configures the top toolbar:
          // left: navigation buttons (prev, next, today)
          // center: the current view‚Äôs title (e.g. ‚ÄúAugust 2025‚Äù)
          // right: view switchers (month ‚Üî week ‚Üî day)

        windowResize: function(view) {
          if (window.innerWidth < 425) {
            calendar.changeView('listWeek'); // smaller screens
            calendar.setOption('headerToolbar', {
              left: '',
              center: '',
              right: 'dayGridMonth,timeGridWeek,timeGridDay'
            });
          } else {
            calendar.changeView('dayGridMonth'); // larger screens
            calendar.setOption('headerToolbar', {
              left: 'prev,next today',
              center: 'title',
              right: 'dayGridMonth,timeGridWeek,timeGridDay'
            });
          }
        },
        // Adjust view based on screen size

        events: {{ events|safe }},  // Adds events to the calendar

        eventDidMount: function(info) {
          // Add custom fields to events (not part of the core set like title, start, end).
          // Tooltip with description + googleMeetLink link

          let tooltip = `${info.event.extendedProps.description || ''}`;
          // info.event is the event object
          // extendedProps holds custom fields you added to events

          if (info.event.extendedProps.meetingLink) {
            tooltip += `\nMeeting: ${info.event.extendedProps.meetingLink}`;
          }

          if (info.event.extendedProps.course) {
            tooltip += `\nCourse: ${info.event.extendedProps.course}`;
          }

          info.el.setAttribute("title", tooltip);
          // info.el is the rendered HTML element for that event
        },

        eventClick: function(info) {
          // When an event is clicked
          document.getElementById("event-details-popup").style.display = "block";
          document.getElementById("event-title").value = info.event.title;
          document.getElementById("event-course").value = info.event.extendedProps.course || '';
          document.getElementById("event-description").value = info.event.extendedProps.description || '';
          document.getElementById("event-meeting-link").value = info.event.extendedProps.meetingLink || '';
          document.getElementById("event-meeting-link-join").href = document.getElementById("event-meeting-link").value.trim() || "#";
        },
      });

      calendar.render();
    });
  </script>


{% endblock %}
