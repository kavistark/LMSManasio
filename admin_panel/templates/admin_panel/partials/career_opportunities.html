{% extends "admin_panel/base.html" %}
{% load static %}

{% block title %}Career Opportunities{% endblock %}

{% block extra_css %}
<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>

<style>
body {
  background: #f4f7fb;
}

/* ===== PAGE HEADER ===== */
.page-header {
  background: linear-gradient(135deg, #2563eb, #1e40af);
  color: #fff;
  padding: 24px;
  border-radius: 16px;
  margin-bottom: 30px;
}
.page-header h2 {
  font-weight: 800;
}
.page-header p {
  opacity: .9;
}

/* ===== CARD ===== */
.card {
  border-radius: 16px;
  border: none;
}
.card-header {
  background: #fff;
  border-bottom: 1px solid #e5e7eb;
  font-weight: 700;
}

/* ===== FORM ===== */
.form-label {
  font-weight: 600;
  color: #374151;
}
.form-control {
  border-radius: 10px;
}
#quill-editor {
  height: 260px;
  border-radius: 12px;
}

/* ===== BUTTON ===== */
.btn-primary {
  border-radius: 10px;
  padding: 10px 22px;
  font-weight: 600;
}

/* ===== TABLE ===== */
.table {
  margin-bottom: 0;
}
.table thead th {
  background: #f1f5f9;
  font-weight: 600;
}
.table td {
  vertical-align: middle;
}

/* ===== SECTION TITLE ===== */
.section-title {
  font-weight: 700;
  color: #0f172a;
  margin: 35px 0 15px;
}

/* ===== EMPTY STATE ===== */
.empty-row {
  text-align: center;
  padding: 30px;
  color: #6b7280;
}
</style>
{% endblock %}

{% block container %}
<div class="container my-4">

  <!-- ===== HEADER ===== -->
  <div class="page-header">
    <h2><i class="fas fa-briefcase me-2"></i>Career Opportunities</h2>
    <p>Create and manage job openings for students</p>
  </div>

  <!-- ===== CREATE JOB ===== -->
  <div class="card shadow-sm mb-5">
    <div class="card-header">
      <h5 class="mb-0">Post New Job</h5>
    </div>
    <div class="card-body">
      <form method="POST">
        {% csrf_token %}

        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label">Job Title</label>
            <input type="text" name="job-title" class="form-control" placeholder="Software Developer" required>
          </div>
          <div class="col-md-6">
            <label class="form-label">Company</label>
            <input type="text" name="company-name" class="form-control" placeholder="Infosys / Google" required>
          </div>

          <div class="col-md-6">
            <label class="form-label">Location</label>
            <input type="text" name="location" class="form-control" placeholder="Bangalore / Remote">
          </div>
          <div class="col-md-6">
            <label class="form-label">Stipend / Salary</label>
            <input type="text" name="stipend" class="form-control" placeholder="₹15,000 / ₹6 LPA">
          </div>

          <div class="col-md-6">
            <label class="form-label">Experience</label>
            <input type="text" name="experience" class="form-control" placeholder="0–2 Years">
          </div>
          <div class="col-md-6">
            <label class="form-label">Apply Link</label>
            <input type="text" name="link" class="form-control" placeholder="https://company.com/careers">
          </div>
        </div>

        <!-- DESCRIPTION -->
        <div class="mt-4">
          <label class="form-label">Job Description</label>
          <div id="quill-editor"></div>
          <input type="hidden" name="job_description" id="content">
        </div>

        <!-- MODE -->
        <div class="mt-4">
          <label class="form-label">Mode</label>
          <div class="d-flex gap-4">
            <div class="form-check">
              <input class="form-check-input" type="radio" name="mode" value="online" checked>
              <label class="form-check-label">Online</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="mode" value="offline">
              <label class="form-check-label">Offline</label>
            </div>
          </div>
        </div>

        {% if success %}
        <div class="alert alert-success mt-3">{{ success }}</div>
        {% endif %}

        <div class="mt-4 text-end">
          <button class="btn btn-primary">
            <i class="fas fa-paper-plane me-1"></i> Publish Job
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- ===== ONLINE JOBS ===== -->
  <h5 class="section-title">Online Students Jobs</h5>
  <div class="card shadow-sm">
    <div class="table-responsive">
      <table class="table table-hover">
        <thead>
          <tr>
            <th>Job Title</th>
            <th>Description</th>
            <th>Date</th>
            <th width="120">Action</th>
          </tr>
        </thead>
        <tbody>
          {% for job in online_students %}
          <tr>
            <td class="fw-semibold">{{ job.job_title }}</td>
            <td class="text-muted">{{ job.job_description|truncatewords:20|safe }}</td>
            <td>{{ job.updated_at|date:"d M Y" }}</td>
            <td>
              <a href="{% url 'delete_job' job_id=job.id %}"
                 class="btn btn-sm btn-outline-danger"
                 onclick="return confirm('Delete this job?')">
                 Delete
              </a>
            </td>
          </tr>
          {% empty %}
          <tr><td colspan="4" class="empty-row">No jobs found</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <!-- ===== OFFLINE JOBS ===== -->
  <h5 class="section-title">Offline Students Jobs</h5>
  <div class="card shadow-sm">
    <div class="table-responsive">
      <table class="table table-hover">
        <thead>
          <tr>
            <th>Job Title</th>
            <th>Description</th>
            <th>Date</th>
            <th width="120">Action</th>
          </tr>
        </thead>
        <tbody>
          {% for job in offline_students %}
          <tr>
            <td class="fw-semibold">{{ job.job_title }}</td>
            <td class="text-muted">{{ job.job_description|truncatewords:20|safe }}</td>
            <td>{{ job.updated_at|date:"d M Y" }}</td>
            <td>
              <a href="{% url 'delete_job' job_id=job.id %}"
                 class="btn btn-sm btn-outline-danger"
                 onclick="return confirm('Delete this job?')">
                 Delete
              </a>
            </td>
          </tr>
          {% empty %}
          <tr><td colspan="4" class="empty-row">No jobs found</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

</div>

<!-- ===== QUILL INIT ===== -->
<script>
const quill = new Quill('#quill-editor', {
  theme: 'snow',
  placeholder: 'Enter job responsibilities, skills, eligibility...',
  modules: {
    toolbar: [
      [{ header: [1, 2, false] }],
      ['bold', 'italic', 'underline'],
      [{ list: 'ordered' }, { list: 'bullet' }],
      ['link', 'blockquote', 'code-block'],
      ['clean']
    ]
  }
});

document.querySelector("form").addEventListener("submit", function () {
  document.getElementById("content").value = quill.root.innerHTML;
});
</script>
{% endblock %}
